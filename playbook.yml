---
- name: Install packages
  connection: local
  hosts: localhost
  tasks:
    - name: macOS packages installed
      when: ansible_facts['distribution'] == "MacOSX"
      community.general.homebrew:
        package:
          - fd
          - fzf
          - go-task
          - helix
          - jq
          - lazygit
          - neovim
          - ripgrep
          - starship
          - yq
    - name: Linux Mint packages installed
      when: ansible_facts['distribution'] == "Linux Mint"
      apt:
        package:
          - fd-find
          - fzf
          - git
          - jq
          - neovim
          - ripgrep
          - task
          - vim
          - yq
          - zsh
    - name: Fedora packages installed
      when: ansible_facts['distribution'] == "Fedora"
      become: true
      dnf:
        pkg:
          - fd-find
          - fzf
          - git
          - go-task
          - neovim
          - ripgrep
          - vim
          - zsh

- name: Create symlinks
  connection: local
  hosts: localhost
  vars:
    xdg_config_dir: ~/.config
  roles:
    - role: stow
      vars:
        target_path: "~"
        src_dir: "{{playbook_dir}}/vim"
    - role: stow
      vars:
        target_path: "~"
        src_dir: "{{playbook_dir}}/zsh"
    - role: stow
      vars:
        target_path: "~"
        src_dir: "{{playbook_dir}}/task"
    - role: stow
      vars:
        target_path: "~"
        src_dir: "{{playbook_dir}}/wezterm"
    - role: stow
      vars:
        target_path: "{{ xdg_config_dir }}/nvim"
        src_dir: "{{playbook_dir}}/neovim"
    - role: stow
      vars:
        target_path: "{{ xdg_config_dir }}/alacritty"
        src_dir: "{{playbook_dir}}/alacritty"
    - role: stow
      vars:
        target_path: "{{ xdg_config_dir }}/helix"
        src_dir: "{{playbook_dir}}/helix"
